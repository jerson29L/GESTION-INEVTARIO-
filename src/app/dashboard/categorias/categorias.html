<header class="flex items-center justify-between mb-8">
  <div><h1 class="text-3xl font-bold text-gray-800">Gestión de Categorías</h1><p class="text-gray-500 mt-1">Organiza tu catálogo de productos por categorías</p></div>
  <button (click)="openNewModal()" class="btn bg-gradient-to-r from-orange-500 to-yellow-500 text-white border-none shadow-md"><lucide-icon name="Plus" class="h-4 w-4 mr-2"></lucide-icon>Nueva Categoría</button>
</header>

<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
  <div class="card bg-white shadow-lg border-0"><div class="card-body p-6"><p class="text-sm font-medium text-gray-500">Total Categorías</p><p class="text-3xl font-bold text-gray-800">{{ categories.length }}</p></div></div>
  <div class="card bg-white shadow-lg border-0"><div class="card-body p-6"><p class="text-sm font-medium text-gray-500">Subcategorías</p><p class="text-3xl font-bold text-gray-800">{{ totalSubcategories }}</p></div></div>
  <div class="card bg-white shadow-lg border-0"><div class="card-body p-6"><p class="text-sm font-medium text-gray-500">Productos Totales</p><p class="text-3xl font-bold text-gray-800">{{ totalProducts }}</p></div></div>
  <div class="card bg-white shadow-lg border-0"><div class="card-body p-6"><p class="text-sm font-medium text-gray-500">Categorías Activas</p><p class="text-3xl font-bold text-gray-800">{{ activeCategoriesCount }}</p></div></div>
</div>

<div class="card bg-white shadow-lg border-0">
  <div class="card-body p-6">
    <div class="flex items-center justify-between mb-4"><h2 class="card-title text-xl text-gray-800">Estructura de Categorías</h2><button class="btn btn-ghost btn-sm"><lucide-icon name="Search" class="h-4 w-4 mr-2"></lucide-icon>Buscar</button></div>
    <div class="space-y-2">
      <div *ngFor="let category of categories" class="border border-gray-200 rounded-lg overflow-hidden">
        <div class="flex items-center justify-between p-4 bg-white hover:bg-gray-50 transition-colors cursor-pointer" (click)="toggleCategory(category.id)">
          <div class="flex items-center space-x-4">
            <lucide-icon [name]="isExpanded(category.id) ? 'ChevronDown' : 'ChevronRight'" class="h-5 w-5 text-gray-400"></lucide-icon>
            <div class="w-10 h-10 rounded-lg flex items-center justify-center" [ngClass]="category.bgColor"><lucide-icon [name]="category.icon" class="h-5 w-5" [ngClass]="category.color"></lucide-icon></div>
            <div><h3 class="font-semibold text-gray-800">{{ category.name }}</h3><p class="text-sm text-gray-500">{{ category.description }}</p></div>
          </div>
          <div class="flex items-center space-x-4">
            <div class="flex items-center"><button (click)="openEditModal(category); $event.stopPropagation()" class="btn btn-ghost btn-sm btn-square"><lucide-icon name="Edit" class="h-4 w-4"></lucide-icon></button><button (click)="$event.stopPropagation()" class="btn btn-ghost btn-sm btn-square text-red-500"><lucide-icon name="Trash2" class="h-4 w-4"></lucide-icon></button></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showFormModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
  <div class="card bg-white w-full max-w-2xl shadow-2xl animate-scale-in">
    <div class="card-body">
      <div class="flex justify-between items-center"><h2 class="card-title text-2xl">{{ selectedCategory ? 'Editar Categoría' : 'Nueva Categoría' }}</h2><button (click)="closeModal()" class="btn btn-sm btn-circle btn-ghost"><lucide-icon name="X"></lucide-icon></button></div>
      <div class="space-y-4 mt-4">
        <label class="form-control w-full"><div class="label"><span class="label-text">Nombre</span></div><input type="text" [(ngModel)]="editingCategory.name" class="input input-bordered w-full" /></label>
        <label class="form-control w-full"><div class="label"><span class="label-text">Descripción</span></div><textarea [(ngModel)]="editingCategory.description" class="textarea textarea-bordered"></textarea></label>
      </div>
      <div class="card-actions justify-end mt-6"><button (click)="closeModal()" class="btn btn-ghost">Cancelar</button><button (click)="saveCategory()" class="btn bg-gradient-to-r from-green-600 to-emerald-600 text-white border-none"><lucide-icon name="Save" class="h-4 w-4 mr-2"></lucide-icon>{{ selectedCategory ? 'Actualizar' : 'Crear' }}</button></div>
    </div>
  </div>
</div>